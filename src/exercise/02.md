# Compound Components

## 游닇 Your Notes

A침ade tus anotaciones aqu칤 `src/exercise/02.md`

## Background

**En pocas palabras:** El patron "Compound Components" te permite proporcionar
una serie de componentes que implicitamente comparten estado a trav칠s de una
simple pero poderosa API declarativa para componentes reutilizables.

Compound componente son componentes que trabajan en conjunto para formar una UI
completa. El cl치sico ejemplo de esto ser칤a la etiqueta `<select>` y `<option>`
en HTML:

```html
<select>
  <option value="1">Option 1</option>
  <option value="2">Option 2</option>
</select>
```

El `<select>` es el elemento responsable de manejar el estado de la UI, y los
elementos `<option>` son esencialmente configuraciones que definen como el
select debe operar (especificamente, que opciones estan disponibles y sus
valores).

Imaginemos que vamos a implementar este control nativo manualmente. Una
implementaci칩n nativa lucir칤a algo como esto:

```jsx
<CustomSelect
  options={[
    {value: '1', display: 'Option 1'},
    {value: '2', display: 'Option 2'},
  ]}
/>
```

Esto funciona bien, pero es menos extensible/flexible que una API de Compound
Components. Por ejemplo. 쯈u칠 pasa si quiero a침adir atributos adicionales a la
`<option>` que se renderiza? 쯢 si quiero que el `display` cambie en funci칩n de
si esta seleccionado? Sencillamente podemos implementar una API para soportar
estos casos de uso, pero eso solo es m치s c칩digo para nosotros y m치s que tendr치n
que aprender los usuarios. Ah칤 es donde los Compound Components son muy 칰tiles!

**Proyectos reales que utilizan este patron:**

- [`@reach/tabs`](https://reacttraining.com/reach-ui/tabs)
- La mayor parte de [Reach UI](https://reacttraining.com/reach-ui) implementa
  este patron

## Ejercicio

Despliegues productivos:

- [Ejercicio](http://advanced-react-patterns.netlify.app/isolated/exercise/02.js)
- [Final](http://advanced-react-patterns.netlify.app/isolated/final/02.js)

Cada componente reutilizable comienza como una implementaci칩n simple para un
caso de uso espec칤fico. Es aconsejable no complicar demasiado los componentes y
no tratar de resolver todos los problemas imaginables que a칰n no tiene (y
probablemente nunca tendr치). Pero a medida que surgen cambios (y casi siempre lo
hacen), querr치 que la implementaci칩n de su componente sea flexible y
modificable. Aprender a hacer eso es el objetivo de gran parte de este workshop.

Es por eso que vamos a comenzar con un componente muy simple `<Toggle />`.

En este ejercicio vamos a hacer que el componente `<Toggle />` sea el padre de
algunos Compound Components.

- `<ToggleOn />` renderiza a su hijo cuando el estado `on` es `true`
- `<ToggleOff />` renderiza a su hijo cuando el estado `on` es `false`
- `<ToggleButton />` renderiza el componente `<Switch />` con la propiedad `on`
  con el valor del estado `on` y la propiedad `onClick` con el valor de
  `toggle`.

Tenemos un componente Toggle que va a administrar el estado y tambi칠n queremos
renderizar diferentes partes de la interfaz de usuario de manera flexible. Cabe
mencionar que lo que queremos es control sobre la presentaci칩n de la interfaz de
usuario.

游불 El desaf칤o fundamental que enfrentas con una API como esta es que el estado
compartido entre los componentes es impl칤cito, lo que significa que el
desarrollador que usa su componente no puede ver ni interactuar con el estado
(`on`) o los mecanismos para actualizar ese estado (`toggle `) que se comparten
entre los componentes.

Entonces, en este ejercicio, resolveremos ese problema proporcionando a los
componentes compuestos las props que necesiten, implicitamente utilizando la API
de `React.cloneElement`.

Aqu칤 se muestra un ejemplo simple utilizando `React.Children.map` y
`React.cloneElement`:

```javascript
function Foo({children}) {
  return React.Children.map(children, (child, index) => {
    return React.cloneElement(child, {
      id: `i-am-child-${index}`,
    })
  })
}

function Bar() {
  return (
    <Foo>
      <div>I will have id "i-am-child-0"</div>
      <div>I will have id "i-am-child-1"</div>
      <div>I will have id "i-am-child-2"</div>
    </Foo>
  )
}
```

## Extra Credit

### 1. 游눮 Support DOM component children

[Despliegue productivo](http://advanced-react-patterns.netlify.app/isolated/final/02.extra-1.js)

> Un componente del DOM es un componente "built-in" 칩 "incorporado" como
> `<div />`, `<span />`, 칩 `<blink />`. Un "composite component" 칩 "componente
> compuesto" es un componente como `<Toggle />` 칩 `<App />`.

Intenta actualizando el componente `App` a esto:

```javascript
function App() {
  return (
    <div>
      <Toggle>
        <ToggleOn>The button is on</ToggleOn>
        <ToggleOff>The button is off</ToggleOff>
        <span>Hello</span>
        <ToggleButton />
      </Toggle>
    </div>
  )
}
```

쯅otas el mensaje de error en la consola? Intenta solventarlo.

## 游불 Feedback

Fill out
[the feedback form](https://ws.kcd.im/?ws=Advanced%20React%20Patterns%20%F0%9F%A4%AF&e=02%3A%20Compound%20Components&em=agustin.moranr%40gmail.com).
